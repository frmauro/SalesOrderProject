version: "3.5"
services:
   dbmysql:
          image: mysql/mysql-server:5.7.31
          environment: 
            - MYSQL_ROOT_HOST=%
            - MYSQL_ROOT_PASSWORD=123
            - MYSQL_DATABASE=orderapi
          networks:
            - net-backend            
          expose:
            - "3306"  
   dbmysqlproduct:
          image: mysql/mysql-server:5.7.31
          environment: 
            - MYSQL_ROOT_HOST=%
            - MYSQL_ROOT_PASSWORD=123
            - MYSQL_DATABASE=productApi
          networks:
            - net-backend            
          expose:
            - "3306"  
   dbmongouser:
          image: mongo
          networks:
            - net-backend  
          ports:
            - "27017:27017"                      
          expose:
            - "27017"  
   order-api:        
          image: orderapi
          restart: on-failure
          depends_on:
            - dbmysql
          ports:
            - 8080:8080
          networks:
            - net-backend            
          environment: 
             DATABASE_HOST: dbmysql
             DATABASE_USER: root
             DATABASE_NAME: orderapi
             DATABASE_PORT: 3306 
   product-api:        
          image: salesproductapi
          restart: on-failure
          depends_on:
            - dbmysqlproduct
          ports:
            - 8087:80
          networks:
            - net-backend            
          environment: 
             DATABASE_HOST: dbmysqlproduct
             DATABASE_USER: root
             DATABASE_NAME: productApi
             DATABASE_PORT: 3306 
   user-api:        
          image: salesapiusernode
          restart: on-failure
          depends_on:
            - dbmongouser
          ports:
            - 8088:8088
          networks:
            - net-backend            
   web-order:        
          image: salesorderfrontend
          restart: on-failure
          depends_on:
            - order-api
            - product-api
          ports:
            - 8086:80
          networks:
            - net-backend            
   web-product:        
          image: salesproductfrontend
          restart: on-failure
          depends_on:
            - product-api
          ports:
            - 8085:80
          networks:
            - net-backend            
   web-user:        
          image: salesuserreact
          restart: on-failure
          build:
            context: ../../reactjs/salesuser/
            dockerfile: Dockerfile
          stdin_open: true  
          depends_on:
            - user-api
          ports:
            - 3000:3000
          networks:
            - net-backend
          environment:
            - NODE_ENV=development                        

networks:
  net-backend:



